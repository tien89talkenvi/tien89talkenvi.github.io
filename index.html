<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Anonystick - example speech to text javasctipt</title>
    <style>
        .btn-start{
            color:black;
        }
    </style>
</head>
<body>
    <button class="btn-start">Micro</button>
    <button class="btn-stop">Stop</button>
    <textarea class="output" cols="30" rows="10"></textarea>
    <script src="./app.js"></script>

<script>
class SpeechRecognitionApi{
    constructor(options) {
        const SpeechToText = window.speechRecognition || window.webkitSpeechRecognition;
        this.speechApi = new SpeechToText();
        this.speechApi.continuous = true;
        this.speechApi.interimResults = false;
        this.output = options.output ? options.output : document.createElement('div');
        console.log(this.output)
        this.speechApi.onresult = (event)=> { 
            console.log(event);
            var resultIndex = event.resultIndex;
            var transcript = event.results[resultIndex][0].transcript;

            console.log('transcript>>', transcript);
            console.log(this.output)
            this.output.textContent = transcript;
        }
    }
    init(){
        this.speechApi.start();
    }
    stop(){
        this.speechApi.stop();
    }

}
//khi trang web duoc tai len thi lam cac viec
window.onload = function(){
    var speech = new SpeechRecognitionApi({             //gan lop SpeechRecognitionApi vao doi tuong speech
        output: document.querySelector('.output')       //voi dau ra la phan tu co ten lop la .output
    })

    document.querySelector('.btn-start').addEventListener('click', function () { //khi click nut .btn-start thi
        speech.init();                                                               //khoi dong speech
        document.querySelector('.btn-start').style.color="red";
    })

    document.querySelector('.btn-stop').addEventListener('click', function () {   //khi click nut .btn-stop
        speech.stop();
        document.querySelector('.btn-start').style.color="black";
    })
}
//xu li <textarea class="output" cols="30" rows="10"></textarea>
document.querySelector('.output').addEventListener('click', readText);
function readText(){
    const text = document.querySelector('.output').value;
    const utterance = new SpeechSynthesisUtterance(text);
    window.speechSynthesis.speak(utterance);
}
</script>

</body>
</html>
