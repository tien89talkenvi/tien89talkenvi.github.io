<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<style>
mark {
  color: #000;
  background-color: #f4d03f;
}
</style>    
</head>
<body>
<div class='f-grid-col-left' id='l1'  onclick='layidvaplay(this.id)'>My name is Tien. I am a teacher.</div>
<div class='f-grid-col-left' id='r2'  onclick='layidvaplay(this.id)'>Tên của tôi là Tiến. Tôi là một giáo viên.</div>

<script>
function layidvaplay(idname){
    function handleEnd() {
        textEl.innerHTML = text;
    }

    function handleBoundary(event) {
        if (event.name === 'sentence') {
            return;
        }

        const wordStart = event.charIndex;
        let wordLength = event.charLength;
        if (wordLength === undefined) {
            // Safari doesn't provide charLength, so fall back to a regex to find the current word and its length (probably misses some edge cases, but good enough for this demo)
            const match = text.substring(wordStart).match(/^[a-z\d']*/i);
            wordLength = match[0].length;
        }
        // wrap word in <mark> tag
        const wordEnd = wordStart + wordLength;
        const word = text.substring(wordStart, wordEnd);
        const markedText = text.substring(0, wordStart) + '<mark>' + word + '</mark>' + text.substring(wordEnd);
        textEl.innerHTML = markedText;
    }

    function play(tenidl) {
        if (window.speechSynthesis.speaking) {
            window.speechSynthesis.resume();
        } else {
            let utterance = new SpeechSynthesisUtterance(text);
            utterance.addEventListener('end', handleEnd);
            utterance.addEventListener('boundary', handleBoundary);
            let giongnoi;
            if (tenidl.charAt(0) == 'l'){giongnoi='en-US';} else {giongnoi='vi-VN';}
            utterance.lang = giongnoi;
            window.speechSynthesis.speak(utterance);
        }
    }
    //
    let text = document.getElementById(idname).innerHTML ;
    let textEl = document.getElementById(idname);
    textEl.innerHTML = text;
    play(idname);
}
</script>      
</body>
</html>
